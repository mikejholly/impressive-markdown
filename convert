#!/usr/bin/env node 
// Generated by CoffeeScript 1.6.2
(function() {
  var context, exists, fs, input, markdown, markdownFile, parts, read, result, sys, template, write, _;

  sys = require('sys');

  fs = require('fs');

  _ = require('underscore');

  markdown = require('markdown').markdown;

  exists = fs.existsSync;

  read = function(input) {
    return fs.readFileSync(input, 'utf-8');
  };

  write = fs.writeFileSync;

  markdownFile = process.argv.pop();

  context = {
    title: process.argv.pop()
  };

  if (!exists(markdownFile)) {
    console.log("Can't find `" + markdownFile + "`.");
    process.exit();
  }

  template = read('./template.html');

  input = read(markdownFile);

  parts = input.split('~');

  parts = _.reject(parts, function(p) {
    return p.length < 1;
  });

  parts = _.map(parts, function(p) {
    return "<div class=\"step\">
  " + (markdown.toHTML(p)) + "
</div>";
  });

  context.slides = parts.join("
");

  result = _.template(template, context);

  write('present.html', result);

}).call(this);
