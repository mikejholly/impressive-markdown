#!/usr/bin/env node 
// Generated by CoffeeScript 1.6.2
(function() {
  var fs, input, markdown, md, parts, slides, sys, template, title, _;

  sys = require('sys');

  fs = require('fs');

  _ = require('underscore');

  markdown = require('markdown').markdown;

  md = process.argv.pop();

  title = process.argv.pop();

  if (!fs.existsSync(md)) {
    console.log("Can't find `" + md + "`.");
    process.exit();
  }

  template = fs.readFileSync('./template.html', 'utf-8');

  input = fs.readFileSync(md, 'utf-8');

  parts = input.split(/---/);

  parts = _.map(parts, function(p) {
    return "<div class=\"step\">
  " + (markdown.toHTML(p)) + "
</div>";
  });

  parts = _.reject(parts);

  slides = parts.join("
");

  template = template.replace('{{ title }}', title);

  template = template.replace('{{ slides }}', slides);

  fs.writeFile('present.html', template);

}).call(this);
